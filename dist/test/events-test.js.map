{"version":3,"sources":["events-test.js"],"names":[],"mappings":"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","file":"events-test.js","sourcesContent":["let assert = require('chai').assert;\nlet sinon = require('sinon');\nlet unison = require('../lib');\n\ndescribe(\"When objects are updated\", () => {\n  let u;\n  beforeEach(() => {\n    u = unison({\n      bird: {name: 'eagle'}\n    });\n  });\n\n  it(\"events should be triggered once for each update\", () => {\n    let callback = sinon.spy();\n\n    u('bird').on('updated', callback);\n    u('bird').update({wingspan: 12});\n    u('bird').update({soaring: 'high'});\n\n    assert.ok(callback.calledTwice);\n  });\n});\n\ndescribe(\"Multiple listeners per event\", () => {\n  it(\"should be supported\", () => {\n    let u = unison({}), spy1 = sinon.spy(), spy2 = sinon.spy();\n    u('').on('childAdded', spy1);\n    u('').on('childAdded', spy2);\n\n    u('').add({});\n    u('').add({});\n\n    assert.ok(spy1.calledTwice);\n    assert.ok(spy2.calledTwice);\n  });\n});\n\ndescribe(\"When children are added\", () => {\n  let u;\n  beforeEach(() => {\n    u = unison({\n      food: {}\n    });\n  });\n\n  it(\"a correct 'childAdded' event should trigger on its parent\", () => {\n    let spy = sinon.spy();\n\n    u('food').on('childAdded', spy);\n    u('food').add('cucumber', {name: 'cucumber'});\n\n    assert.ok(spy.calledOnce);\n    assert.ok(spy.calledWith('cucumber'));\n  });\n\n  it(\"a correct 'created' event should trigger on the child\", () => {\n    let spy = sinon.spy();\n\n    u('food.cucumber').on('created', spy);\n    u('food').add('cucumber', {name: 'cucumber'});\n\n    assert.ok(spy.calledOnce);\n  });\n\n  it(\"'childAdded' and 'created' events should trigger for nested objects\", () => {\n    let created = sinon.spy(), childAdded = sinon.spy(),\n      deepCreated = sinon.spy(), deepChildAdded = sinon.spy();\n\n    u('food.apple.seed.inside').on('created', deepCreated);\n    u('food.apple.seed.outside').on('created', deepCreated);\n    u('food.apple.seed').on('created', created);\n    u('food.apple').on('childAdded', childAdded);\n    u('food.apple.seed').on('childAdded', deepChildAdded);\n\n    u('food').add('apple', { seed: { inside: {}, outside: {} } });\n\n    assert.ok(created.calledOnce);\n    assert.ok(childAdded.calledOnce);\n    assert.ok(deepCreated.calledTwice);\n    assert.ok(deepChildAdded.calledTwice);\n  });\n});\n\ndescribe(\"When children are removed\", () => {\n  let u;\n  beforeEach(() => {\n    u = unison({\n      food: {\n        apple: {seed: {inside: {}, outside: {}}}\n      }\n    });\n  });\n\n  it(\"a correct 'childRemoved' event should trigger on its parent\", () => {\n    let spy = sinon.spy();\n\n    u('food.apple.seed').on('childRemoved', spy);\n    u('food.apple.seed.inside').destroy();\n\n    assert.ok(spy.calledOnce);\n    assert.ok(spy.calledWith('inside'));\n  });\n\n  it(\"a correct 'destroyed' event should trigger on the child\", () => {\n    let spy = sinon.spy();\n\n    u('food.apple.seed.inside').on('destroyed', spy);\n    u('food.apple.seed.inside').destroy();\n\n    assert.ok(spy.calledOnce);\n  });\n\n  it(\"'childRemoved' and 'destroyed' events should trigger for nested objects\", () => {\n    let destroyed = sinon.spy(), childRemoved = sinon.spy(), deepDestroyed = sinon.spy();\n\n    u('food.apple.seed.inside').on('destroyed', deepDestroyed);\n    u('food.apple.seed.outside').on('destroyed', deepDestroyed);\n    u('food.apple.seed').on('destroyed', destroyed);\n    u('food.apple').on('childRemoved', childRemoved);\n\n    u('food.apple').destroy();\n\n    assert.ok(destroyed.calledOnce);\n    assert.ok(childRemoved.calledOnce);\n    assert.ok(deepDestroyed.calledTwice);\n  });\n});"],"sourceRoot":"../../test"}