{"version":3,"sources":["events-test.js"],"names":[],"mappings":"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","file":"events-test.js","sourcesContent":["let assert = require('chai').assert;\nlet sinon = require('sinon');\nlet unison = require('../lib');\n\ndescribe(\"When objects are updated\", () => {\n  let $$;\n  beforeEach(() => {\n    $$ = unison({\n      bird: {name: 'eagle'}\n    });\n  });\n\n  it(\"events should be triggered once for each update\", () => {\n    let callback = sinon.spy();\n\n    $$('bird').on('updated', callback);\n    $$('bird').update({wingspan: 12});\n    $$('bird').update({soaring: 'high'});\n\n    assert.ok(callback.calledTwice);\n  });\n});\n\ndescribe(\"Multiple listeners per event\", () => {\n  it(\"should be supported\", () => {\n    let $$ = unison({}), spy1 = sinon.spy(), spy2 = sinon.spy();\n    $$('').on('childAdded', spy1);\n    $$('').on('childAdded', spy2);\n\n    $$('').add({});\n    $$('').add({});\n\n    assert.ok(spy1.calledTwice);\n    assert.ok(spy2.calledTwice);\n  });\n});\n\ndescribe(\"When children are added\", () => {\n  let $$;\n  beforeEach(() => {\n    $$ = unison({\n      food: {}\n    });\n  });\n\n  it(\"a correct 'childAdded' event should trigger on its parent\", () => {\n    let spy = sinon.spy();\n\n    $$('food').on('childAdded', spy);\n    $$('food').add('cucumber', {name: 'cucumber'});\n\n    assert.ok(spy.calledOnce);\n    assert.ok(spy.calledWith('cucumber'));\n  });\n\n  it(\"a correct 'created' event should trigger on the child\", () => {\n    let spy = sinon.spy();\n\n    $$('food.cucumber').on('created', spy);\n    $$('food').add('cucumber', {name: 'cucumber'});\n\n    assert.ok(spy.calledOnce);\n  });\n\n  it(\"'childAdded' and 'created' events should trigger for nested objects\", () => {\n    let created = sinon.spy(), childAdded = sinon.spy(),\n      deepCreated = sinon.spy(), deepChildAdded = sinon.spy();\n\n    $$('food.apple.seed.inside').on('created', deepCreated);\n    $$('food.apple.seed.outside').on('created', deepCreated);\n    $$('food.apple.seed').on('created', created);\n    $$('food.apple').on('childAdded', childAdded);\n    $$('food.apple.seed').on('childAdded', deepChildAdded);\n\n    $$('food').add('apple', { seed: { inside: {}, outside: {} } });\n\n    assert.ok(created.calledOnce);\n    assert.ok(childAdded.calledOnce);\n    assert.ok(deepCreated.calledTwice);\n    assert.ok(deepChildAdded.calledTwice);\n  });\n});\n\ndescribe(\"When children are removed\", () => {\n  let $$;\n  beforeEach(() => {\n    $$ = unison({\n      food: {\n        apple: {seed: {inside: {}, outside: {}}}\n      }\n    });\n  });\n\n  it(\"a correct 'childRemoved' event should trigger on its parent\", () => {\n    let spy = sinon.spy();\n\n    $$('food.apple.seed').on('childRemoved', spy);\n    $$('food.apple.seed.inside').destroy();\n\n    assert.ok(spy.calledOnce);\n    assert.ok(spy.calledWith('inside'));\n  });\n\n  it(\"a correct 'destroyed' event should trigger on the child\", () => {\n    let spy = sinon.spy();\n\n    $$('food.apple.seed.inside').on('destroyed', spy);\n    $$('food.apple.seed.inside').destroy();\n\n    assert.ok(spy.calledOnce);\n  });\n\n  it(\"'childRemoved' and 'destroyed' events should trigger for nested objects\", () => {\n    let destroyed = sinon.spy(), childRemoved = sinon.spy(), deepDestroyed = sinon.spy();\n\n    $$('food.apple.seed.inside').on('destroyed', deepDestroyed);\n    $$('food.apple.seed.outside').on('destroyed', deepDestroyed);\n    $$('food.apple.seed').on('destroyed', destroyed);\n    $$('food.apple').on('childRemoved', childRemoved);\n\n    $$('food.apple').destroy();\n\n    assert.ok(destroyed.calledOnce);\n    assert.ok(childRemoved.calledOnce);\n    assert.ok(deepDestroyed.calledTwice);\n  });\n});"],"sourceRoot":"../../test"}