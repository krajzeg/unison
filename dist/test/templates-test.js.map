{"version":3,"sources":["templates-test.js"],"names":[],"mappings":"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","file":"templates-test.js","sourcesContent":["let _ = require('lodash');\nlet assert = require('chai').assert;\nlet unison = require('../lib');\nlet templates = require('../lib').templates;\n\nlet client = require('../lib').client;\nvar CommunicationMock = require('./mocks/client-comm');\n\n\n\ndescribe(\"Templates plugin\", () => {\n  let u;\n\n  beforeEach(() => {\n    u = unison({}).plugin(templates({\n      creatures: {\n        goblin: {name: \"Goblin\"}\n      }\n    }))\n  });\n\n  it(\"should automatically apply templates to add()-ed objects\", () => {\n    u().add('goblin', {template: 'creatures.goblin', life: 12});\n    assert.equal(u('goblin').get.name, 'Goblin');\n    assert.equal(u('goblin').get.life, 12);\n    assert.equal(u('goblin').get.template, 'creatures.goblin');\n  });\n\n  it(\"should do nothing to objects that don't want templates\", () => {\n    u().add('banana', {juiciness: 7});\n    assert.ok(u('banana').get);\n    assert.equal(u('banana').get.juiciness, 7);\n  });\n\n  it(\"should keep the template after updates\", () => {\n    let goblin = u().add('goblin', {template: 'creatures.goblin', life: 12});\n    goblin.update({life: 6});\n    assert.equal(goblin.get.life, 6);\n    assert.equal(goblin.get.name, 'Goblin');\n  });\n\n  it(\"should apply templates for objects seeded from server\", () => {\n    let comm = new CommunicationMock();\n    u.plugin(client({communication: comm}));\n\n    comm.pushServerCommand('_seed', '', {\n      creatures: {\n        creature1: {template: 'creatures.goblin', life: 10}\n      }\n    });\n\n    assert.equal(u('creatures.creature1').get.name, 'Goblin');\n  });\n\n  it(\"should apply the template before 'created' listeners run\", () => {\n    let names = {};\n    u().onChild('created', (evt) => {\n      names[evt.snapshot.path()] = evt.snapshot.get.name;\n    });\n    u().add('goblin', {template: 'creatures.goblin'});\n    assert.equal(names['goblin'], 'Goblin');\n  });\n\n  it(\"should expose a spawn() method to easily create templated objects\", () => {\n    u().spawn('creatures.goblin', {life: 12});\n    assert.equal(u('goblin#1').get.name, 'Goblin');\n    assert.equal(u('goblin#1').get.life, 12);\n  });\n\n  it(\"should give access to the templates via u.template()\", () => {\n    assert.equal(u.template('creatures.goblin').name, 'Goblin');\n  });\n});"],"sourceRoot":"../../test"}