{"version":3,"sources":["queue-test.js"],"names":[],"mappings":"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","file":"queue-test.js","sourcesContent":["let assert = require('chai').assert;\nimport Queue from '../lib/task-queues'\n\ndescribe(\"Task queues\", () => {\n  it(\"should execute synchronous tasks synchronously\", () => {\n    let q = new Queue();\n\n    let a = 0;\n    q.schedule(() => { a += 1; });\n    q.schedule(() => { a *= 2; });\n    q.schedule(() => { a += 3; });\n    q.schedule(() => { a *= 5; });\n\n    assert.equal(a, 25);\n  });\n\n  it(\"should execute asynchronous tasks one at a time in order\", (done) => {\n    let q = new Queue();\n\n    let a = 0;\n    q.schedule(() =>\n      wait(10).then(() => { a += 1; })\n    );\n    q.schedule(() =>\n      wait(10).then(() => { a *= 2; })\n    );\n    q.schedule(() =>\n      wait(10).then(() => { a += 3; })\n    );\n    q.schedule(() =>\n      wait(10).then(() => { a *= 5; })\n    );\n\n    q.waitUntilEmpty().then(() => {\n      assert.equal(a, 25);\n    }).then(done).catch(done);\n  });\n\n  it(\"should create automatically queued functions with synchronize\", (done) => {\n    let q = new Queue();\n\n    let a = 0;\n    let multiply = q.synchronize((x) =>\n      wait(10).then(() => { a *= x; })\n    );\n    let add = q.synchronize((x) =>\n      wait(10).then(() => { a += x; })\n    );\n\n    add(2);\n    multiply(3);\n    add(5);\n    multiply(7);\n\n    q.waitUntilEmpty().then(() => {\n      assert.equal(a, 77);\n    }).then(done).catch(done);\n  });\n});\n\nfunction wait(ms) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, ms);\n  });\n}\n\n"],"sourceRoot":"../../test"}